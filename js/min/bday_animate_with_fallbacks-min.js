var yesSmil=Modernizr.smil,noSmil=!Modernizr.smil;$(window).load(function(){function e(e){if(e.hasAttribute("type")){var t=e.getAttribute("type");if("image/svg+xml"===t){var o=e.contentDocument;if(null==o)console.log("Changing svg to png. obj.contentDocument is null or undef so we do not change the visibility");else{var n=o.querySelector("svg");n.setAttribute("visibility","hidden")}e.removeAttribute("type")}}if(e.hasAttribute("data")){var i=e.getAttribute("data");console.log("Original objData = "+i),e.removeAttribute("data")}if("svg"===e.className){var l=e.getAttribute("class");console.log("Original objClass = "+l),e.className="svgfallback";var a=e.className;console.log("new objClass = "+a)}}function t(){if(noSmil)if(Modernizr.svg)e(d),console.log("Boo.  SMIL animation not supported. But the good news is that SVG IS!");else{var t=[d,p,m],o=t.length,n;for(n=0;o>n;n++)e(t[n]);console.log("Boo. SMIL and SVG are not supported")}else console.log("YAY! SMIL animation supported!")}function o(e,t){e.addEventListener?e.addEventListener("click",t,!1):(e.attachEvent("onclick",t),console.log("Event listener added via IE attachEvent fallback"))}function n(e){if(!e){var e=window.event;e.cancelBubble=!0,e.returnValue=!1}return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1}function i(){$.Velocity(p,{translateY:[-f,"0px"]}),$.Velocity(m,{translateY:[f,"0px"]}),$.Velocity.RunSequence(b)}function l(){i(),$(h).velocity({translateX:[.8,0],translateY:[4.8,0],scale:[.8,1]},{duration:1e3,loop:!0})}function a(){yesSmil?l():Modernizr.cssanimations?i():($(u).velocity("fadeOut"),console.log("No animation support"))}function s(){$(v).velocity("fadeOut",{duration:500,display:"none"}),yesSmil?($(h).velocity("stop"),$(h).velocity({translateX:[4,0],translateY:[24,0],scale:[0,1]},1e3,function(){$(x).velocity({strokeDashoffset:["0","110"]},1500).velocity({strokeDashoffset:["-110","0"]},1500)}),$.Velocity.RunSequence(k)):($(d).velocity("spriteSmotherNSmoke"),$.Velocity.RunSequence(k))}function r(e){0||a(),n(e)}function c(e){"blow_out"===e.target.id?s():"replay"===e.target.id&&window.location.reload(),n(e)}console.log("window loaded");var u=document.getElementById("overlay"),d=document.getElementById("cake_obj"),p=document.getElementById("banner_obj"),m=document.getElementById("balloons_obj"),g=document.getElementById("underlay"),v=document.getElementById("blow_out"),y=document.getElementById("replay"),f=function(){var e=document.body,t=$(e).height();return t}(),b=[{elements:u,properties:{opacity:[0,1]},options:{duration:1500,delay:100,display:"none"}},{elements:d,properties:{scale:[.5,1]},options:{duration:1500}},{elements:p,properties:{translateY:["0px",-f]},options:{duration:4e3,sequenceQueue:!1}},{elements:d,properties:"reverse",options:{duration:1500,sequenceQueue:!1}},{elements:v,properties:"fadeIn",options:{duration:500,display:"block"}},{elements:v,properties:"callout.shake"}],k=[{elements:m,properties:{translateY:["0px",f]},options:{duration:5e3}},{elements:y,properties:"fadeIn",options:{duration:500,display:"block"}}],S=d.contentDocument;if(null==S)console.log("oops. cakeObj.contentDocument is null or undefined - "+S);else{console.log("awesome. cakeObj.contentDocument does have a value");var h=S.querySelectorAll(".flame_group"),x=S.querySelectorAll(".smoke")}$.Velocity.RegisterUI("spriteSmotherNSmoke",{defaultDuration:1e3,calls:[[{backgroundPositionX:["-500px","-500px"]},.15],[{backgroundPositionX:["-1000px","-1000px"]},.15],[{backgroundPositionX:["-1500px","-1500px"]},.15],[{backgroundPositionX:["-2000px","-2000px"]},.15],[{backgroundPositionX:["-2500px","-2500px"]},.15],[{backgroundPositionX:["-3000px","-3000px"]},.25]],reset:{backgroundPositionX:"-3000px"}}),t(),o(u,r),o(g,c)});